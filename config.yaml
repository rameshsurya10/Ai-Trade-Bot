market_mode: both
symbols:
- BTC/USDT
- ETH/USDT
- EUR/USD
- XAU/USD
exchange: binance
data:
  symbol: BTC/USDT
  exchange: binance
  interval: 15m
  history_days: 365
  websocket:
    enabled: true
    reconnect_delay: 5
    max_reconnects: 10
    ping_interval: 30
    buffer_size: 40000
analysis:
  update_interval: 60
  min_confidence: 0.55
  lookback_period: 100
model:
  path: models/best_model.pt
  models_dir: models
  sequence_length: 60
  hidden_size: 128
  num_layers: 2
  dropout: 0.2
  features:
    technical_features: 32
    sentiment_features: 7
    total_features: 39
    include_sentiment: true
timeframes:
  enabled: true
  aggregation_method: weighted_vote
  min_confidence: 0.5
  alignment_threshold: 1.0
  intervals:
  - interval: 15m
    enabled: true
    weight: 0.4
    sequence_length: 96
    min_training_interval_minutes: 120
  - interval: 1h
    enabled: true
    weight: 0.6
    sequence_length: 60
    min_training_interval_minutes: 240
  - interval: 4h
    enabled: false
    weight: 0.0
    sequence_length: 42
    min_training_interval_minutes: 480
  - interval: 1d
    enabled: false
    weight: 0.0
    sequence_length: 30
    min_training_interval_minutes: 1440
news:
  enabled: true
  sources:
    newsapi:
      enabled: true
      api_key_env: NEWSAPI_KEY
      fetch_interval: 1800
      max_requests_per_day: 100
      max_articles_per_fetch: 100
      lookback_hours: 6
    alphavantage:
      enabled: true
      api_key_env: ALPHAVANTAGE_KEY
      fetch_interval: 7200
      max_requests_per_day: 25
      max_articles_per_fetch: 50
      lookback_hours: 12
  sentiment:
    analyzer: vader
    custom_lexicon:
      bullish: 0.8
      moon: 0.6
      mooning: 0.7
      hodl: 0.4
      buy: 0.5
      pump: 0.6
      rally: 0.7
      surge: 0.6
      breakout: 0.7
      uptrend: 0.6
      gainz: 0.7
      lambo: 0.5
      diamond hands: 0.6
      bearish: -0.8
      dump: -0.7
      dumping: -0.7
      crash: -0.9
      sell: -0.5
      panic: -0.7
      fud: -0.6
      rekt: -0.8
      bag holder: -0.6
      downtrend: -0.6
      correction: -0.4
      drop: -0.5
      plunge: -0.7
      collapse: -0.9
      paper hands: -0.6
      volatile: -0.3
      volatility: -0.2
      uncertainty: -0.4
      regulation: -0.3
      ban: -0.7
      adoption: 0.6
      institutional: 0.5
      etf: 0.4
      halving: 0.5
      upgrade: 0.6
  features:
    lookback_hours:
    - 1
    - 6
    - 24
    time_weighted: true
    decay_rate: 0.1
    min_articles: 1
currencies: null
prediction:
  confidence_floor: 0.45
  confidence_ceiling: 0.65
  regime_penalties:
    TRENDING: 1.0
    NORMAL: 1.0
    CHOPPY: 0.85
    VOLATILE: 0.80
  buy_threshold: 0.52
  sell_threshold: 0.48

  fourier:
    dynamic_prob: true
    amplitude: 0.15
    n_harmonics: 5
    min_samples: 32
    phase_bullish_upper: 0.25
    phase_neutral_upper: 0.50
    phase_bearish_upper: 0.75
    prob_bullish: 0.75
    prob_bearish: 0.25
    prob_neutral: 0.50
    default_period: 20.0

  kalman:
    dynamic_prob: true
    sigmoid_sensitivity: 2.0
    process_variance: 0.00001
    measurement_variance: 0.01
    initial_error_covariance: 1.0
    velocity_lookback: 10
    prob_up: 0.70
    prob_down: 0.30
    prob_sideways: 0.50

  entropy:
    dynamic_prob: true
    certainty_scaling: 0.8
    n_bins: 10
    lookback: 50
    min_samples: 10
    trending_threshold: 0.55
    normal_threshold: 0.75
    choppy_threshold: 0.88
    prob_trending_up: 0.65
    prob_trending_down: 0.35
    prob_normal_up: 0.55
    prob_normal_down: 0.45
    low_entropy_threshold: 0.5

  markov:
    n_states: 3
    min_samples: 20
    damping: 0.8
    percentile_lower: 33
    percentile_upper: 67

  monte_carlo:
    n_simulations: 1000
    time_horizon: 24
    default_volatility: 0.02
    default_stop_loss_pct: 0.02
    default_take_profit_pct: 0.03
    min_returns_samples: 10
    var_weight: 0.5
    annualization_factor: 252

  ensemble:
    symmetric_confidence: false
    # Ensemble weights: 'lstm' slot carries blended LSTM+boosting signal
    # Give ML models dominant weight since math algos average ~0.50
    weights:
      lstm: 0.55          # LSTM + XGBoost/LightGBM blend (the trained ML signal)
      fourier: 0.10       # Cycle detection (supplementary)
      kalman: 0.15        # Trend following (useful signal)
      markov: 0.10        # State transitions (supplementary)
      entropy: 0.05       # Regime detection (minor)
      monte_carlo: 0.05   # Risk simulation (minor)
    sentiment_weight: 0.05
    sentiment_1h_weight: 0.6
    sentiment_6h_weight: 0.4
    sentiment_clamp_min: 0.2
    sentiment_clamp_max: 0.8
    mc_scaling: 20
    mc_clamp_min: 0.2
    mc_clamp_max: 0.8

  atr:
    period: 14
    default_pct: 0.02
    sl_multiplier: 2
    tp_multiplier: 3
    sl_pct_min: 0.01
    sl_pct_max: 0.05
    tp_pct_min: 0.015
    tp_pct_max: 0.10

  kelly:
    max_fraction: 0.25

  rules:
    cycle_buy_max_phase: 0.7
    cycle_sell_min_phase: 0.3
    markov_min_prob: 0.55
    mc_min_win_prob: 0.50
    min_risk_reward: 1.5
    max_daily_volatility: 0.05
    min_confidence: 0.60
    min_kelly: 0.01

  online_update:
    output_clamp_min: 0.01
    output_clamp_max: 0.99
    max_loss_threshold: 2.0
    grad_clip_max_norm: 1.0
auto_training:
  enabled: true
  min_accuracy_required: 0.50  # LSTM near-random on financial data; math ensemble drives confidence
  target_accuracy: 0.60
  max_epochs: 100
  batch_size: 64
  learning_rate: 0.0005
  patience: 10
  min_candles: 1000
  training_candles: 5000
  min_trades_before_retrain: 50
  max_days_between_retrain: 30
  min_win_rate_threshold: 0.45
  scheduler:
    enabled: true
    factor: 0.5
    patience: 5
    min_lr: 0.00001
continuous_learning:
  enabled: true
  confidence:
    trading_threshold: 0.65
    hysteresis: 0.05
    smoothing_alpha: 0.3
    regime_adjustment: true
  retraining:
    on_loss: true
    consecutive_loss_threshold: 3
    win_rate_threshold: 0.45
    drift_threshold: 0.7
    min_interval_hours: 1
    max_epochs: 50
    target_confidence: 0.65
    patience: 10
    recent_candles: 5000
    replay_mix_ratio: 0.3
    min_samples: 1000
    replay_loss_importance: 2.0
    replay_win_importance: 1.0
    win_rate_lookback: 100
    drift_min_samples: 10
    drift_decay_factor: 0.95
    drift_high_conf_threshold: 0.7
    drift_high_conf_weight: 1.5
    min_candles_for_features: 100
  experience_replay:
    buffer_size: 10000
    replay_mix_ratio: 0.3
    prioritize_losses: true
    batch_size: 32
  ewc:
    lambda: 1000.0
    fisher_sample_size: 200
  online_learning:
    enabled: true
    learning_rate: 0.0005
    update_frequency: 1
    min_price_change_pct: 0.001
  stale_cleanup_interval: 100
  prediction_max_age_minutes: 60
  drift_window: 100
  exit_logic:
    stop_loss_pct: 2.0
    take_profit_pct: 4.0
    max_holding_hours: 24
  historical_replay:
    enabled: true
    days: 30
    interval: '15m'
    log_every: 100
algorithm_weights:
  fourier: 0.15
  kalman: 0.25
  entropy: 0.1
  markov: 0.2
  lstm: 0.3
signals:
  risk_per_trade: 0.02
  risk_reward_ratio: 2.0
  strong_signal: 0.65
  medium_signal: 0.55
  cooldown_minutes: 60
portfolio:
  initial_capital: 10000
  max_position_percent: 0.25
  max_total_positions: 10
  reserve_cash_percent: 0.05
  base_currency: USD
  position_sizing: equal_weight
risk:
  max_drawdown_percent: 20
  max_sector_exposure: 0.4
  daily_loss_limit: 0.05
  position_size_method: risk_parity
  max_position_percent: 0.25
position_sizing:
  method: risk_parity
  target_volatility: 0.1
  kelly_fraction: 0.5
  max_position_size: 0.25
notifications:
  desktop:
    enabled: true
    sound: true
    sound_file: alert.wav
  telegram:
    enabled: false
    bot_token: ''
    chat_id: ''
  email:
    enabled: false
    smtp_server: smtp.gmail.com
    smtp_port: 587
    sender: ''
    password: ''
    recipient: ''
database:
  path: data/trading.db
  backup_enabled: true
  backup_interval_hours: 24
dashboard:
  host: localhost
  port: 8501
  theme: light
  auto_refresh: true
  refresh_interval: 2
logging:
  level: INFO
  file: data/trading.log
  max_size_mb: 10
  backup_count: 3
live_trading:
  mode: paper
  default_exchange: binance
  default_symbols:
  - BTC/USDT
  - ETH/USDT
  heartbeat_interval: 300
brokerages:
  binance:
    testnet: false
  alpaca:
    paper: true
  mt5:
    demo: true
    terminal_path: ''
    server: ''
    bridge_host: localhost
    bridge_port: 5555
    magic_number: 234000
mt5:
  enabled: false
  demo: true
  terminal_path: ''
  server: ''
  bridge_host: localhost
  bridge_port: 5555
  poll_interval_ms: 2000
  tick_poll_interval_ms: 500
  magic_number: 234000
  pairs:
  - EUR/USD
  - GBP/USD
  - USD/JPY
  - USD/CHF
  - AUD/USD
  - NZD/USD
  - USD/CAD
  intervals:
  - interval: 15m
    weight: 0.4
    sequence_length: 96
  - interval: 1h
    weight: 0.6
    sequence_length: 60
# Gradient Boosting (XGBoost + LightGBM) ensemble
boosting:
  enabled: true
  xgboost:
    n_estimators: 200
    max_depth: 6
    learning_rate: 0.05
    subsample: 0.8
    colsample_bytree: 0.8
    min_child_weight: 3
  lightgbm:
    n_estimators: 200
    num_leaves: 31
    learning_rate: 0.05
    subsample: 0.8
    colsample_bytree: 0.8
    min_child_samples: 20
  ensemble_weight: 0.6   # Boosting weight in LSTM+Boosting blend (LSTM gets 1-this)
  min_samples: 500       # Minimum candles required to train
  retrain_interval: 168  # Hours between retraining (1 week)

twelvedata:
  enabled: true
  backfill_count: 1200
  buffer_size: 5000
  pairs:
    - EUR/USD
    - XAU/USD
  intervals:
    - interval: 1h
      weight: 0.6
      sequence_length: 60
  polling:
    divisor: 5          # Poll interval = candle_interval / divisor (1h/5 = 12 min)
    min_seconds: 8      # Minimum seconds between API calls
    max_seconds: 720    # Maximum seconds between polls
  rate_limit:
    per_minute: 8       # Free tier: 8 requests/minute
    per_day: 800        # Free tier: 800 requests/day
    warn_threshold: 700 # Log warning when daily calls reach this
forex:
  enabled: true
  broker: twelvedata
  pairs:
    majors:
    - EUR/USD
    metals:
    - XAU/USD
  leverage:
    default: 50
    majors: 50
    minors: 20
    max_allowed: 50
  risk:
    max_risk_per_trade: 1.0
    max_position_percent: 10.0
    max_correlation_exposure: 40.0
  spread:
    max_spread_multiplier: 3.0
    reduce_spread_multiplier: 2.0
  margin:
    call_level: 50
    stop_out_level: 30
  swap:
    include_in_risk: true
    warn_triple_swap: true
  sessions:
    sydney:
      start: 21
      end: 6
    tokyo:
      start: 0
      end: 9
    london:
      start: 8
      end: 17
    new_york:
      start: 13
      end: 22
strategy_analysis:
  classification:
    scalping_hours: 1
    momentum_confidence: 0.85
    momentum_min_hours: 1
    momentum_max_hours: 4
    swing_min_hours: 4
    swing_max_hours: 24
    position_min_hours: 24
  min_trades_per_strategy: 3
  min_total_trades: 10
  metrics:
    sharpe_trading_days: 252
    cache_ttl_seconds: 60
  dashboard:
    default_lookback_days: 7
    min_lookback_days: 1
    max_lookback_days: 30
confidence_gate:
  min_threshold_clamp: 0.50
  max_threshold_clamp: 0.95
  max_history_size: 100
performance_tracking:
  min_signals_for_retrain_check: 20
  win_rate_retrain_threshold: 0.45
  initial_retrain_after_signals: 100
  days_between_retrains: 30
  min_signals_for_periodic_retrain: 50
